<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>—Ä—É–ª–µ—Ç–∫–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(150deg, #fef3f8 0%, #ffeef4 100%);
            font-family: 'Segoe UI', 'Roboto', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* —Ü–≤–µ—Ç—ã –ø–∞–¥–∞—é—Ç –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ */
        .rain-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            overflow: hidden;
        }

        .falling-flower {
            position: absolute;
            font-size: 2.2rem;
            opacity: 0.8;
            animation: fall linear forwards;
            color: #ff9eb5;
            filter: drop-shadow(0 5px 8px rgba(255, 180, 200, 0.7));
            pointer-events: none;
            z-index: 10000;
            will-change: transform;
        }

        @keyframes fall {
            0% { transform: translateY(-10vh) rotate(0deg); opacity: 0.9; }
            100% { transform: translateY(110vh) rotate(480deg); opacity: 0.2; }
        }

        /* –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–ª—å–∫–æ —Å –∫–æ–ª–µ—Å–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π */
        .wheel-card {
            max-width: 600px;
            width: 100%;
            background: rgba(255, 245, 250, 0.7);
            backdrop-filter: blur(4px);
            border-radius: 70px 30px 70px 30px;
            box-shadow: 0 25px 40px rgba(255, 150, 180, 0.3),
                        0 0 0 2px rgba(255, 255, 255, 0.8) inset;
            padding: 25px 25px 35px 25px;
            border: 1px solid rgba(255, 220, 230, 0.9);
            position: relative;
            z-index: 100;
            text-align: center;
        }

        .wheel-wrapper {
            position: relative;
            width: min(70vw, 340px);
            height: min(70vw, 340px);
            margin: 0 auto 20px auto;
        }

        canvas {
            width: 100%;
            height: 100%;
            display: block;
            border-radius: 50%;
            background: #ffe7ef;
            box-shadow: 0 15px 30px rgba(240, 140, 170, 0.5),
                        0 0 0 3px white inset,
                        0 0 0 6px #ffd0dd;
            cursor: pointer;
            transition: transform 0.1s ease;
        }

        canvas:active {
            transform: scale(0.98);
        }

        .pointer {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            width: 0; height: 0;
            border-left: 22px solid transparent;
            border-right: 22px solid transparent;
            border-top: 34px solid #ffa5bc;
            filter: drop-shadow(0 8px 6px rgba(255, 140, 170, 0.5));
            z-index: 12;
        }

        .spin-button {
            background: #ffd5e2;
            border: 4px solid white;
            color: #a55e71;
            font-size: 2rem;
            padding: 10px 40px;
            border-radius: 50px 20px 50px 20px;
            cursor: pointer;
            box-shadow: 0 12px 0 #e6b7c8, 0 15px 25px rgba(255, 150, 180, 0.4);
            transition: 0.08s linear;
            margin: 5px 0 0;
            display: inline-block;
            letter-spacing: 2px;
            border: 3px solid white;
            font-family: 'Georgia', serif;
        }

        .spin-button:active {
            transform: translateY(8px);
            box-shadow: 0 4px 0 #e6b7c8, 0 12px 20px rgba(255, 150, 180, 0.4);
        }

        /* –º–æ–¥–∞–ª–∫–∞ */
        .flower-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 210, 225, 0.5);
            backdrop-filter: blur(8px);
            z-index: 100000;
            align-items: center;
            justify-content: center;
        }

        .flower-modal-content {
            background: rgba(255, 245, 250, 0.95);
            backdrop-filter: blur(10px);
            border: 4px solid white;
            border-radius: 80px 30px 80px 30px;
            padding: 35px 30px;
            max-width: 380px;
            width: 90%;
            text-align: center;
            box-shadow: 0 40px 50px #feb0c2;
            animation: popIn 0.3s;
        }

        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .modal-big-emoji {
            font-size: 6rem;
            line-height: 1;
            margin-bottom: 15px;
            filter: drop-shadow(0 8px 10px #ffb7c5);
        }

        .modal-text {
            font-size: 2rem;
            color: #a15168;
            margin: 10px 0;
            text-transform: capitalize; /* –ø–µ—Ä–≤–∞—è –±—É–∫–≤–∞ –∑–∞–≥–ª–∞–≤–Ω–∞—è */
        }

        .modal-close-btn {
            background: #ffc1d2;
            border: 3px solid white;
            border-radius: 60px;
            padding: 8px 30px;
            font-size: 1.3rem;
            color: #7a4452;
            cursor: pointer;
            transition: 0.2s;
            display: inline-block;
            margin-top: 10px;
        }

        .modal-close-btn:hover {
            background: #ffd5e2;
            transform: scale(1.05);
            box-shadow: 0 10px 20px #ffb0c0;
        }

        @media (max-width: 500px) {
            .wheel-card { padding: 20px 15px; }
            .spin-button { font-size: 1.8rem; padding: 8px 25px; }
        }
    </style>
</head>
<body>

    <!-- –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ø–∞–¥–∞—é—â–∏—Ö —Ü–≤–µ—Ç–æ–≤ (–ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ) -->
    <div class="rain-container" id="rainContainer"></div>

    <div class="wheel-card">
        <div class="wheel-wrapper">
            <div class="pointer"></div>
            <canvas id="wheelCanvas" width="600" height="600"></canvas>
        </div>
        <button class="spin-button" id="spinBtn">–∫—Ä—É—Ç–∏—Ç—å</button>
    </div>

    <!-- –º–æ–¥–∞–ª–∫–∞ -->
    <div class="flower-modal" id="flowerModal">
        <div class="flower-modal-content">
            <div class="modal-big-emoji" id="modalFlowerEmoji">üå∏</div>
            <div class="modal-text" id="modalFlowerName">–°–∞–∫—É—Ä–∞</div>
            <div class="modal-close-btn" id="closeModalBtn">–∑–∞–∫—Ä—ã—Ç—å</div>
        </div>
    </div>

    <script>
        (function() {
            // ----- –¢–û–õ–¨–ö–û –≠–ú–û–î–ó–ò –ò–ó –§–ê–ô–õ–ê (8 —à—Ç—É–∫, —Å –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏) -----
            const flowers = [
                { emoji: 'üå∏', name: '–°–∞–∫—É—Ä–∞' },
                { emoji: 'üåº', name: '–†–æ–º–∞—à–∫–∞' },
                { emoji: 'üåª', name: '–ü–æ–¥—Å–æ–ª–Ω—É—Ö' },
                { emoji: 'üå∫', name: '–ì–∏–±–∏—Å–∫—É—Å' },
                { emoji: 'üå∑', name: '–¢—é–ª—å–ø–∞–Ω' },
                { emoji: 'üåπ', name: '–†–æ–∑–∞' },
                { emoji: 'üå∏', name: '–°–∞–∫—É—Ä–∞' },
                { emoji: 'üåø', name: '–í–µ—Ç–æ—á–∫–∞' }
            ];
            const sectorCount = 8;

            const canvas = document.getElementById('wheelCanvas');
            const ctx = canvas.getContext('2d');
            const spinBtn = document.getElementById('spinBtn');
            const modal = document.getElementById('flowerModal');
            const modalEmoji = document.getElementById('modalFlowerEmoji');
            const modalName = document.getElementById('modalFlowerName');
            const rainContainer = document.getElementById('rainContainer');

            let currentRotation = 0;
            let isSpinning = false;
            let animFrame = null;
            let spinVelocity = 0;
            let stopTimeout = null;

            // –æ—á–µ–Ω—å –ø–ª–∞–≤–Ω–æ–µ –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ
            const friction = 0.985;
            const minSpin = 0.005;

            // ----- –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–æ–ª–µ—Å–∞ (—Ä–æ–∑–æ–≤–æ–µ) -----
            function drawWheel(rotation) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                const radius = canvas.width * 0.42;
                const angleStep = (Math.PI * 2) / sectorCount;

                for (let i = 0; i < sectorCount; i++) {
                    const start = i * angleStep + rotation;
                    const end = start + angleStep;

                    ctx.fillStyle = (i % 2 === 0) ? '#ffd9e6' : '#ffe4f0';
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.arc(centerX, centerY, radius, start, end);
                    ctx.closePath();
                    ctx.fill();

                    ctx.strokeStyle = '#ffffff';
                    ctx.lineWidth = 2.5;
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.arc(centerX, centerY, radius, start, end);
                    ctx.lineTo(centerX, centerY);
                    ctx.stroke();

                    ctx.save();
                    ctx.translate(centerX, centerY);
                    const midAngle = start + angleStep / 2;
                    ctx.rotate(midAngle);
                    
                    const textRadius = radius * 0.7;
                    ctx.font = `500 ${radius * 0.45}px 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', sans-serif`;
                    ctx.fillStyle = '#9f5f74';
                    ctx.shadowColor = '#ffb7c5';
                    ctx.shadowBlur = 12;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(flowers[i].emoji, textRadius, 0);
                    
                    ctx.restore();
                }

                ctx.beginPath();
                ctx.arc(centerX, centerY, 14, 0, 2 * Math.PI);
                ctx.fillStyle = '#ffffff';
                ctx.shadowBlur = 16;
                ctx.shadowColor = '#ffb0c0';
                ctx.fill();
                ctx.shadowBlur = 0;
                ctx.strokeStyle = '#ffb7c5';
                ctx.lineWidth = 3;
                ctx.stroke();
            }

            drawWheel(currentRotation);

            // ----- –¥–æ–∂–¥—å —Ü–≤–µ—Ç–æ–≤ (–¢–û–õ–¨–ö–û –≠–ú–û–î–ó–ò –ò–ó –§–ê–ô–õ–ê) -----
            function startFlowerRain(emoji, count = 50) {
                // –º–∞—Å—Å–∏–≤ —ç–º–æ–¥–∑–∏ —Ç–æ–ª—å–∫–æ –∏–∑ —Ñ–∞–π–ª–∞
                const fileEmojis = ['üå∏', 'üåº', 'üåª', 'üå∫', 'üå∑', 'üåπ', 'üå∏', 'üåø'];
                
                for (let i = 0; i < count; i++) {
                    setTimeout(() => {
                        const flower = document.createElement('div');
                        flower.className = 'falling-flower';
                        
                        // 80% –ø–∞–¥–∞—é—â–∏—Ö —Ü–≤–µ—Ç–æ–≤ = –≤—ã–ø–∞–≤—à–∏–π —ç–º–æ–¥–∑–∏ (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω)
                        if (emoji && Math.random() < 0.8) {
                            flower.textContent = emoji;
                        } else {
                            // –≤—ã–±–∏—Ä–∞–µ–º –¢–û–õ–¨–ö–û –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞
                            flower.textContent = fileEmojis[Math.floor(Math.random() * fileEmojis.length)];
                        }
                        
                        flower.style.left = Math.random() * 100 + '%';
                        flower.style.animationDuration = (Math.random() * 3 + 2.5) + 's';
                        flower.style.fontSize = (Math.random() * 2 + 1.8) + 'rem';
                        flower.style.opacity = 0.7 + Math.random() * 0.3;
                        rainContainer.appendChild(flower);

                        setTimeout(() => {
                            if (flower.parentNode) flower.remove();
                        }, 6000);
                    }, i * 30);
                }
            }

            // ----- –ø–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è -----
            function spinAnimation() {
                if (!isSpinning) return;

                spinVelocity *= friction;
                currentRotation += spinVelocity;
                drawWheel(currentRotation);

                if (Math.abs(spinVelocity) > minSpin) {
                    animFrame = requestAnimationFrame(spinAnimation);
                } else {
                    isSpinning = false;
                    if (animFrame) {
                        cancelAnimationFrame(animFrame);
                        animFrame = null;
                    }

                    // –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—ã–ø–∞–≤—à–∏–π —Ü–≤–µ—Ç–æ–∫
                    let norm = (currentRotation % (2 * Math.PI) + 2 * Math.PI) % (2 * Math.PI);
                    const upAngle = (3 * Math.PI) / 2;
                    let localUp = upAngle - norm;
                    localUp = (localUp % (2 * Math.PI) + 2 * Math.PI) % (2 * Math.PI);
                    const angleStep = (2 * Math.PI) / sectorCount;
                    let index = Math.floor(localUp / angleStep);
                    if (index >= sectorCount) index = sectorCount - 1;

                    const result = flowers[index];

                    // –ª–∏–≤–µ–Ω—å –∏–∑ —Ü–≤–µ—Ç–æ–≤ (—Ç–æ–ª—å–∫–æ —ç–º–æ–¥–∑–∏ –∏–∑ —Ñ–∞–π–ª–∞)
                    startFlowerRain(result.emoji, 55);

                    // –º–æ–¥–∞–ª–∫–∞ —á–µ—Ä–µ–∑ 0.5 —Å–µ–∫
                    if (stopTimeout) clearTimeout(stopTimeout);
                    stopTimeout = setTimeout(() => {
                        modalEmoji.textContent = result.emoji;
                        modalName.textContent = result.name; // —É–∂–µ —Å –∑–∞–≥–ª–∞–≤–Ω–æ–π
                        modal.style.display = 'flex';
                    }, 500);
                }
            }

            // –∑–∞–ø—É—Å–∫
            function startSpin() {
                if (isSpinning) return;

                modal.style.display = 'none';
                if (stopTimeout) {
                    clearTimeout(stopTimeout);
                    stopTimeout = null;
                }

                isSpinning = true;

                // —Å–∫–æ—Ä–æ—Å—Ç—å –¥–ª—è ~5‚Äì6 –æ–±–æ—Ä–æ—Ç–æ–≤
                const targetFull = 10 * Math.PI;
                const randomAdd = Math.random() * 2 * Math.PI;
                const totalAngle = targetFull + randomAdd;
                spinVelocity = totalAngle * (1 - friction) * 1.2;

                if (animFrame) cancelAnimationFrame(animFrame);
                animFrame = requestAnimationFrame(spinAnimation);
            }

            spinBtn.addEventListener('click', startSpin);
            canvas.addEventListener('click', startSpin);

            modal.addEventListener('click', function(e) {
                if (e.target === modal || e.target.closest('.modal-close-btn')) {
                    modal.style.display = 'none';
                }
            });

            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && modal.style.display === 'flex') {
                    modal.style.display = 'none';
                }
            });
        })();
    </script>
</body>
</html>