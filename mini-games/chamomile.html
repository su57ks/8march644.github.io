<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–∞–¥–∞–Ω–∏–µ –Ω–∞ —Ä–æ–º–∞—à–∫–µ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(145deg, #ffecf2 0%, #ffdae8 100%);
            font-family: 'Segoe UI', 'Roboto', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        .floating-bg {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        .floating-bg span {
            position: absolute;
            font-size: 2rem;
            opacity: 0.15;
            color: #ff99bb;
            animation: float 16s linear infinite;
        }
        @keyframes float {
            0% { transform: translateY(-10vh) rotate(0deg); }
            100% { transform: translateY(110vh) rotate(360deg); }
        }

        .card {
            max-width: 800px;
            width: 100%;
            background: rgba(255, 250, 252, 0.85);
            backdrop-filter: blur(8px);
            border-radius: 70px 30px 70px 30px;
            box-shadow: 0 25px 45px rgba(255, 140, 170, 0.3),
                        0 0 0 2px rgba(255, 255, 255, 0.7) inset;
            padding: 30px 20px 40px;
            border: 2px solid #ffd9e6;
            position: relative;
            z-index: 20;
            text-align: center;
        }

        h1 {
            font-size: clamp(2.8rem, 8vw, 4rem);
            color: #af4d6e;
            font-family: 'Georgia', serif;
            font-weight: 350;
            text-shadow: 3px 3px 12px #ffb7c9;
            margin-bottom: 5px;
        }

        .subhead {
            font-size: 1.5rem;
            color: #b06b80;
            background: rgba(255, 235, 245, 0.8);
            padding: 0.5rem 2rem;
            border-radius: 50px;
            width: fit-content;
            margin: 0 auto 30px;
            border: 1px solid white;
            box-shadow: 0 5px 15px #ffc0d5;
            font-style: italic;
        }

        .daisy {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px 0 10px;
        }

        .flower {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .center {
            width: 100px;
            height: 100px;
            background: radial-gradient(circle at 30% 30%, #fff8b0, #f7b32b 80%, #ca8323);
            border-radius: 50%;
            box-shadow: 0 8px 18px rgba(210, 120, 30, 0.4), inset -5px -8px 10px #b35f1a, inset 8px 8px 25px #fffde0;
            border: 3px solid #fff3cf;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #ffec9e;
            text-shadow: 2px 2px 0 #b45f1a;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .center::after {
            content: "‚Ä¢ ‚Ä¢ ‚Ä¢";
            position: absolute;
            font-size: 1rem;
            color: #ffd966;
            opacity: 0.7;
            letter-spacing: 6px;
            transform: rotate(-15deg);
        }

        .petals-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .petal {
            position: absolute;
            width: 80px;
            height: 130px;
            background: linear-gradient(145deg, #fff9fc, #ffffff 60%, #ffeef4);
            border-radius: 50% 50% 40% 40%;
            box-shadow: 0 10px 18px rgba(255, 120, 150, 0.3), inset -3px -5px 8px #ffdbea, inset 4px 5px 15px white;
            border: 2px solid rgba(255, 255, 255, 0.9);
            pointer-events: auto;
            transition: opacity 0.2s ease;
            backdrop-filter: blur(1px);
            
            transform-origin: center bottom;
            
            top: 50%;
            left: 50%;
            
            margin-top: -130px;
            
            opacity: 1;
        }

        .petal:nth-child(odd) {
            background: linear-gradient(145deg, #ffffff, #fff3fa 90%);
        }

        .spinning .petal {
            animation: spinPetal 0.2s infinite linear;
        }
        .spinning .center {
            animation: pulseGlow 0.2s infinite alternate;
        }
        
        @keyframes spinPetal {
            0% { transform: translate(-50%, 0) rotate(var(--rot)); }
            100% { transform: translate(-50%, 0) rotate(calc(var(--rot) + 360deg)); }
        }
        
        @keyframes pulseGlow {
            from { box-shadow: 0 0 0 0 #ffcf9a; }
            to { box-shadow: 0 0 20px 10px #ffe6aa; }
        }

        .fortune {
            font-size: 2.4rem;
            background: rgba(255, 250, 250, 0.9);
            padding: 15px 30px;
            border-radius: 50px;
            border: 3px solid white;
            margin: 15px auto 20px;
            display: inline-block;
            color: #a1375a;
            font-weight: 500;
            box-shadow: 0 5px 20px #ffb7c9;
            min-width: 260px;
            backdrop-filter: blur(5px);
        }

        .button-panel {
            display: flex;
            gap: 25px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 15px 0 5px;
        }

        .btn {
            border: 4px solid white;
            border-radius: 60px;
            padding: 16px 38px;
            font-size: 2rem;
            font-weight: 700;
            background: #ffd5e2;
            color: #8f3e55;
            cursor: pointer;
            box-shadow: 0 10px 20px #ffa5bd;
            transition: 0.15s;
            min-width: 210px;
            letter-spacing: 1px;
            border: 2px solid white;
        }
        .btn:active { transform: scale(0.94); }
        .btn.hidden { display: none; }
        .btn:disabled {
            opacity: 0.5;
            pointer-events: none;
            filter: grayscale(0.3);
        }

        .btn-spin {
            background: #ffe4b0;
            color: #964b60;
        }

        .final-modal {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(255, 210, 230, 0.5);
            backdrop-filter: blur(8px);
            align-items: center;
            justify-content: center;
            z-index: 300;
        }
        .final-content {
            background: rgba(255, 245, 252, 0.96);
            border-radius: 80px 30px 80px 30px;
            border: 4px solid white;
            padding: 45px 35px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 30px 40px #ffb0c2;
            animation: pop 0.4s;
        }
        @keyframes pop {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .final-message {
            font-size: 2.6rem;
            color: #a1375a;
            margin: 25px 0;
        }
        .modal-btn {
            background: #ffc1d2;
            border: 3px solid white;
            border-radius: 60px;
            padding: 12px 40px;
            font-size: 1.8rem;
            color: #7a4452;
            cursor: pointer;
            font-weight: 600;
        }
    </style>
</head>
<body>

<div class="floating-bg" id="floatingBg"></div>

<div class="card">
    <h1>üåº –ì–∞–¥–∞–Ω–∏–µ –Ω–∞ —Ä–æ–º–∞—à–∫–µ</h1>
    <div class="subhead">–û—Ç–æ—Ä–≤–∏ –ª–µ–ø–µ—Å—Ç–æ–∫ ‚Äî —É–∑–Ω–∞–π —Å—É–¥—å–±—É</div>

    <div class="daisy">
        <div class="flower" id="flower">
            <div class="center"></div>
            <div class="petals-container" id="petalsContainer"></div>
        </div>
    </div>

    <div class="fortune" id="fortuneText">üå∏ –ù–∞–∂–º–∏ "–æ—Ç–æ—Ä–≤–∞—Ç—å"</div>

    <div class="button-panel">
        <button class="btn" id="pluckBtn">üå∏ –û—Ç–æ—Ä–≤–∞—Ç—å</button>
        <button class="btn btn-spin hidden" id="spinBtn">üåÄ –ì–∞–¥–∞—Ç—å</button>
    </div>
</div>

<div class="final-modal" id="finalModal">
    <div class="final-content">
        <div style="font-size:4rem;">üå∏üåºüå∏</div>
        <div class="final-message" id="finalResult"></div>
        <div class="modal-btn" onclick="closeFinalModal()">–°–ø–∞—Å–∏–±–æ ‚ú®</div>
    </div>
</div>

<script>
(function() {
    const PHRASES = [
        "–õ—é–±–∏—Ç üíñ",
        "–ù–µ –ª—é–±–∏—Ç üñ§",
        "–ü–ª—é–Ω–µ—Ç üíß",
        "–ü–æ—Ü–µ–ª—É–µ—Ç üíã",
        "–ö —Å–µ—Ä–¥—Ü—É –ø—Ä–∏–∂–º—ë—Ç ü§ó",
        "–ö —á—ë—Ä—Ç—É –ø–æ—à–ª—ë—Ç üëø"
    ];

    const petalsContainer = document.getElementById('petalsContainer');
    const flowerEl = document.getElementById('flower');
    const fortuneText = document.getElementById('fortuneText');
    const pluckBtn = document.getElementById('pluckBtn');
    const spinBtn = document.getElementById('spinBtn');
    const finalModal = document.getElementById('finalModal');
    const finalResultSpan = document.getElementById('finalResult');

    // –°–æ—Å—Ç–æ—è–Ω–∏–µ
    let totalPetals = 12;           // –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–µ–ø–µ—Å—Ç–∫–æ–≤ (9-12)
    let visiblePetals = 12;         // —Å–∫–æ–ª—å–∫–æ —Å–µ–π—á–∞—Å –≤–∏–¥–Ω–æ
    let currentPhraseIndex = 0;     // –∏–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–π —Ñ—Ä–∞–∑—ã
    
    // –•—Ä–∞–Ω–∏–º —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤—Å–µ –ª–µ–ø–µ—Å—Ç–∫–∏
    let petalElements = [];

    // –°–æ–∑–¥–∞—ë–º –≤—Å–µ –ª–µ–ø–µ—Å—Ç–∫–∏ —Å—Ä–∞–∑—É (max 12) —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏
    function createAllPetals(maxCount) {
        petalsContainer.innerHTML = '';
        petalElements = [];
        
        const angleStep = 360 / maxCount;

        for (let i = 0; i < maxCount; i++) {
            const angle = angleStep * i;
            const petal = document.createElement('div');
            petal.className = 'petal';
            
            // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –Ω–∞ –≤—Å—ë –≤—Ä–µ–º—è
            petal.style.transform = `translate(-50%, 0) rotate(${angle}deg)`;
            petal.style.setProperty('--rot', angle + 'deg');
            
            petalsContainer.appendChild(petal);
            petalElements.push(petal);
        }
    }

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ count –ª–µ–ø–µ—Å—Ç–∫–æ–≤
    function setVisiblePetals(count) {
        for (let i = 0; i < petalElements.length; i++) {
            petalElements[i].style.opacity = i < count ? '1' : '0';
        }
        visiblePetals = count;
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    function initGame() {
        // –°–ª—É—á–∞–π–Ω–æ–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç 9 –¥–æ 12
        totalPetals = Math.floor(Math.random() * 4) + 9; // 9,10,11,12
        createAllPetals(totalPetals);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –ª–µ–ø–µ—Å—Ç–∫–∏ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ
        setVisiblePetals(totalPetals);
        
        // –°–õ–£–ß–ê–ô–ù–û–ï –ø–µ—Ä–≤–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
        currentPhraseIndex = Math.floor(Math.random() * PHRASES.length);
        fortuneText.innerText = PHRASES[currentPhraseIndex];
        
        pluckBtn.classList.remove('hidden');
        spinBtn.classList.add('hidden');
        flowerEl.classList.remove('spinning');
        pluckBtn.disabled = false;
        spinBtn.disabled = false;
    }

    // –û—Ç–æ—Ä–≤–∞—Ç—å –ª–µ–ø–µ—Å—Ç–æ–∫ - —Å–∫—Ä—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–∏–¥–∏–º—ã–π
    function pluckPetal() {
        if (visiblePetals <= 0) return;

        // –ò–¥—ë–º —Å –∫–æ–Ω—Ü–∞ –º–∞—Å—Å–∏–≤–∞ –∏ –Ω–∞—Ö–æ–¥–∏–º –ø–µ—Ä–≤—ã–π –≤–∏–¥–∏–º—ã–π –ª–µ–ø–µ—Å—Ç–æ–∫
        for (let i = petalElements.length - 1; i >= 0; i--) {
            if (petalElements[i].style.opacity === '1') {
                petalElements[i].style.opacity = '0';
                break;
            }
        }
        
        visiblePetals--;

        // –°–ª–µ–¥—É—é—â–∞—è —Ñ—Ä–∞–∑–∞ –ø–æ –ø–æ—Ä—è–¥–∫—É
        currentPhraseIndex = (currentPhraseIndex + 1) % PHRASES.length;
        fortuneText.innerText = PHRASES[currentPhraseIndex];

        // –ï–°–õ–ò –ù–ï –û–°–¢–ê–õ–û–°–¨ –õ–ï–ü–ï–°–¢–ö–û–í (0) - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
        if (visiblePetals === 0) {
            // –ü–æ—Å–ª–µ–¥–Ω—è—è —Ñ—Ä–∞–∑–∞ - —ç—Ç–æ –∏ –µ—Å—Ç—å —Å—É–¥—å–±–∞
            finalResultSpan.innerText = PHRASES[currentPhraseIndex];
            finalModal.style.display = 'flex';

            pluckBtn.classList.add('hidden');
            spinBtn.classList.remove('hidden');
        }
    }

    // –†–∞—Å–∫—Ä—É—Ç–∫–∞ (–≥–∞–¥–∞—Ç—å)
    function startSpin() {
        if (visiblePetals !== 0) return;

        spinBtn.disabled = true;
        flowerEl.classList.add('spinning');
        fortuneText.innerText = 'üåÄ –í—Ä–∞—â–∞—é...';

        // –¶–µ–ª–µ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ - —Å–ª—É—á–∞–π–Ω–æ–µ –æ—Ç 9 –¥–æ 12
        const targetCount = Math.floor(Math.random() * 4) + 9;
        
        // –ü–ª–∞–≤–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–µ–ø–µ—Å—Ç–∫–∏ –æ–¥–∏–Ω –∑–∞ –¥—Ä—É–≥–∏–º
        let current = 0;
        
        const interval = setInterval(() => {
            if (!flowerEl.classList.contains('spinning')) {
                clearInterval(interval);
                return;
            }

            current++;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ª–µ–ø–µ—Å—Ç–∫–∏ –ø–æ –æ—á–µ—Ä–µ–¥–∏ (–ø–µ—Ä–≤—ã–µ current —à—Ç—É–∫)
            for (let i = 0; i < petalElements.length; i++) {
                petalElements[i].style.opacity = i < current ? '1' : '0';
            }

            if (current >= targetCount) {
                clearInterval(interval);
                setTimeout(() => {
                    if (flowerEl.classList.contains('spinning')) {
                        finishSpin(targetCount);
                    }
                }, 200);
            }
        }, 100);
    }

    function finishSpin(newCount) {
        flowerEl.classList.remove('spinning');
        visiblePetals = newCount;
        
        // –ù–û–í–û–ï —Å–ª—É—á–∞–π–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–∞—É–Ω–¥–∞
        currentPhraseIndex = Math.floor(Math.random() * PHRASES.length);
        fortuneText.innerText = '‚ú® –ì–∞–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–æ ‚ú®';

        pluckBtn.classList.remove('hidden');
        spinBtn.classList.add('hidden');
        spinBtn.disabled = false;

        flowerRain(18);
    }

    function flowerRain(count) {
        for (let i = 0; i < count; i++) {
            setTimeout(() => {
                const d = document.createElement('div');
                d.textContent = ['üå∏','üå∑','üåº','üå∫','üåπ'][Math.floor(Math.random()*5)];
                d.style.position = 'fixed';
                d.style.left = Math.random() * 100 + '%';
                d.style.top = '-5%';
                d.style.fontSize = (Math.random() * 2 + 1.5) + 'rem';
                d.style.zIndex = '999';
                d.style.pointerEvents = 'none';
                d.style.animation = `float ${Math.random()*2+2}s linear forwards`;
                document.body.appendChild(d);
                setTimeout(() => d.remove(), 3000);
            }, i * 40);
        }
    }

    window.closeFinalModal = function() {
        finalModal.style.display = 'none';
    };

    window.onclick = function(e) {
        if (e.target === finalModal) finalModal.style.display = 'none';
    };

    function createBgPetals() {
        const bg = document.getElementById('floatingBg');
        for (let i=0; i<20; i++) {
            const s = document.createElement('span');
            s.textContent = ['üå∏','üå∑','üåº','üå∫'][Math.floor(Math.random()*4)];
            s.style.left = Math.random()*100 + '%';
            s.style.animationDuration = (Math.random()*10+12)+'s';
            s.style.animationDelay = Math.random()*-10+'s';
            s.style.fontSize = (Math.random()*1.8+1.2)+'rem';
            bg.appendChild(s);
        }
    }

    pluckBtn.addEventListener('click', () => {
        if (visiblePetals > 0) pluckPetal();
    });

    spinBtn.addEventListener('click', startSpin);

    document.querySelector('h1').addEventListener('click', ()=> flowerRain(25));

    initGame();
    createBgPetals();
})();
</script>
</body>
</html>
