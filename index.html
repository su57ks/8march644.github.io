<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>–° 8 –º–∞—Ä—Ç–∞ ‚Äî –∏–º–µ–Ω–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏</title>
    <link rel="stylesheet" href="themes/base.css">
    <link rel="stylesheet" href="themes/themes.css">
</head>
<body id="mainBody">

    <div class="petals-front" id="petalsFront"></div>

    <div class="main-card">
        <div class="settings-button" id="settingsButton" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">‚öôÔ∏è</div>

        <h1 class="main-title" id="titleClick" role="button" tabindex="0">–° 8 –º–∞—Ä—Ç–∞</h1>
        <div class="soft-sub">—Å–∞–º—ã–µ –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–µ –∏ –Ω–µ–∂–Ω—ã–µ</div>

        <div class="names-wishes" id="namesContainer"></div>

        <div class="game-section">
            <div class="game-title">
                <span>üå∏</span> –°–æ–±–µ—Ä–∏ –±—É–∫–µ—Ç <span>üå∑</span>
            </div>
            <div class="clicker-area">
                <div class="counter-display" id="flowerCounter">üå∫ 0</div>
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="big-flower" id="clickFlower" role="button" tabindex="0" aria-label="–ö–ª–∏–∫–Ω–∏ —Ü–≤–µ—Ç–æ–∫">üå∏</div>
                <div class="game-hint" id="gameHint">–ö–ª–∏–∫–∞–π –Ω–∞ —Ü–≤–µ—Ç–æ–∫ ‚ú®</div>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –≥–∞–¥–∞–Ω–∏—è –Ω–∞ —Ä–æ–º–∞—à–∫–µ -->
        <div class="daisy-button-container">
            <button class="daisy-game-btn" id="daisyGameBtn">
                <span>üåº</span> –ì–∞–¥–∞–Ω–∏–µ –Ω–∞ —Ä–æ–º–∞—à–∫–µ (10üå∏) <span>üåº</span>
            </button>
        </div>

        <div class="signature" id="easterEgg" role="button" tabindex="0">
            <span>üíó</span> by Aizen with love <span>üíó</span>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ò -->
    <div id="nameModal" class="custom-modal">
        <div class="custom-modal-content">
            <div class="modal-flower" id="modalNameIcon">üå∏</div>
            <div class="modal-message" id="modalNameTitle">–ê–Ω–Ω–∞</div>
            <div id="modalWishes" class="wish-lines"></div>
            <div class="modal-btn" onclick="closeNameModal()">–°–ø–∞—Å–∏–±–æ ‚ú®</div>
        </div>
    </div>

    <div id="victoryModal" class="custom-modal">
        <div class="custom-modal-content">
            <div class="modal-flower">üå∏üå∑üå∏</div>
            <div class="modal-message" id="victoryMessage">üéâ 100 —Ü–≤–µ—Ç–æ–≤!<br>–¢—ã –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–∞! üéâ</div>
            <div class="modal-btn" onclick="closeVictoryModal()">–°–ø–∞—Å–∏–±–æ ‚ú®</div>
        </div>
    </div>

    <div id="complimentModal" class="custom-modal">
        <div class="custom-modal-content">
            <div class="modal-flower">üíê‚ú®üíê</div>
            <div class="modal-message" id="complimentMessage">–¢—ã —Å—É–ø–µ—Ä!</div>
            <div class="modal-btn" onclick="closeComplimentModal()">üå∏ –°–ø–∞—Å–∏–±–æ</div>
        </div>
    </div>

    <div id="promoModal" class="custom-modal">
        <div class="custom-modal-content">
            <div class="modal-flower">üéÅüíóüéÅ</div>
            <div class="modal-message">–ù–∞–¥–µ—é—Å—å, –≤—ã –º–µ–Ω—è –Ω–µ –Ω–µ–Ω–∞–≤–∏–¥–∏—Ç–µ)<br>–í–æ—Ç –≤–∞–º –ø–æ–¥–∞—Ä–æ–∫ - –≤–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥<br><span style="font-size:1.3rem;">(–ü–æ–¥—Å–∫–∞–∑–∫–∞: —ç—Ç–æ –º–µ–º–Ω–æ–µ —á–∏—Å–ª–æ)</span></div>
            <input type="text" id="promoCodeInput" class="promo-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä 1488" maxlength="10" inputmode="numeric">
            <div class="modal-btn" id="applyPromoCodeBtn">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</div>
            <div class="modal-btn" onclick="closePromoModal()" style="margin-top:8px; background:#ffe2ed;">–ó–∞–∫—Ä—ã—Ç—å</div>
        </div>
    </div>

    <div id="settingsModal" class="custom-modal settings-modal">
        <div class="custom-modal-content">
            <div class="modal-flower">‚öôÔ∏èüå∏‚öôÔ∏è</div>
            <div class="modal-message">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            <div class="slider-row">
                <label for="petalCountSlider">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–µ–ø–µ—Å—Ç–∫–æ–≤: <span id="petalCountValue">25</span></label>
                <input type="range" id="petalCountSlider" min="0" max="200" value="25" step="1">
            </div>
            <div class="about-dev">
                üíª –û —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö
            </div>
            <div class="dev-links">
                <div>‚úèÔ∏è –ê–≤—Ç–æ—Ä: <a href="https://t.me/su57ks" target="_blank" rel="noopener">@su57ks</a></div>
                <div>üí° –ò–¥–µ–∏: <a href="https://t.me/selyswag" target="_blank" rel="noopener">@selyswag</a></div>
                <div class="thanks">üôè –°–ø–∞—Å–∏–±–æ –ï–≥–æ—Ä—É –ï. –∏ –î–µ–Ω–∏—Å—É –°.</div>
            </div>
            <div class="modal-btn" onclick="closeSettingsModal()">–ó–∞–∫—Ä—ã—Ç—å</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –≥–∞–¥–∞–Ω–∏—è –Ω–∞ —Ä–æ–º–∞—à–∫–µ -->
    <div id="daisyModal" class="custom-modal daisy-modal">
        <div class="custom-modal-content daisy-content">
            <div class="modal-flower">üåºüåºüåº</div>
            <div class="modal-message">–ì–∞–¥–∞–Ω–∏–µ –Ω–∞ —Ä–æ–º–∞—à–∫–µ</div>
            
            <div class="daisy-game-container">
                <div class="daisy" id="daisyGame">
                    <div class="flower" id="daisyFlower">
                        <div class="center"></div>
                        <div class="petals-container" id="daisyPetalsContainer"></div>
                    </div>
                </div>
                
                <div class="daisy-fortune" id="daisyFortuneText">üå∏ –ù–∞–∂–º–∏ "–û—Ç–æ—Ä–≤–∞—Ç—å"</div>
                
                <div class="daisy-controls">
                    <button class="daisy-btn" id="daisyPluckBtn">üå∏ –û—Ç–æ—Ä–≤–∞—Ç—å</button>
                    <button class="daisy-btn daisy-spin-btn hidden" id="daisySpinBtn">üåÄ –ì–∞–¥–∞—Ç—å</button>
                </div>
                
                <div class="daisy-cost">–°—Ç–æ–∏–º–æ—Å—Ç—å –≥–∞–¥–∞–Ω–∏—è: 10 —Ü–≤–µ—Ç–æ–≤ ‚ú®</div>
            </div>
            
            <div class="modal-btn daisy-close-btn" onclick="closeDaisyModal()">–ó–∞–∫—Ä—ã—Ç—å</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π (–∑–∞–º–µ–Ω–∞ alert) -->
    <div id="messageModal" class="custom-modal message-modal">
        <div class="custom-modal-content message-content">
            <div class="modal-flower" id="messageModalIcon">üí¨</div>
            <div class="modal-message" id="messageModalText">–°–æ–æ–±—â–µ–Ω–∏–µ</div>
            <div class="modal-btn" onclick="closeMessageModal()">OK</div>
        </div>
    </div>

    <script>
        // ==================== –î–ê–ù–ù–´–ï –ò–ú–Å–ù ====================
        const namesData = [
            { icon: 'üå∏', name: '–û–ª—å–≥–∞ –ù–∏–∫–æ–ª–∞–µ–≤–Ω–∞', special: true, wishes: [
                '–° 8 –º–∞—Ä—Ç–∞, –û–ª—å–≥–∞ –ù–∏–∫–æ–ª–∞–µ–≤–Ω–∞!',
                '–í—ã ‚Äî —Å–∞–º—ã–π –ª—É—á—à–∏–π –∫–ª–∞—Å—Å–Ω—ã–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å!',
                '–ó–¥–æ—Ä–æ–≤—å—è, —Å—á–∞—Å—Ç—å—è –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è!',
                '–ü—É—Å—Ç—å —É—á–µ–Ω–∏–∫–∏ —Ä–∞–¥—É—é—Ç –∫–∞–∂–¥—ã–π –¥–µ–Ω—å! üíê'
            ]},
            { icon: 'üå∑', name: '–õ—É–∫–µ—Ä—å—è', wishes: [
                '–ù–µ–∂–Ω–∞—è –õ—É–∫–µ—Ä—å—è, —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º!',
                '–ü—É—Å—Ç—å –≤–µ—Å–Ω–∞ –ø–æ–¥–∞—Ä–∏—Ç –º–Ω–æ–≥–æ —Ü–≤–µ—Ç–æ–≤!',
                '–°—á–∞—Å—Ç—å—è, –ª—é–±–≤–∏ –∏ –∫—Ä–∞—Å–æ—Ç—ã! ‚ú®'
            ]},
            { icon: 'üå∏', name: '–ö–∞—Ä–∏–Ω–∞', wishes: [
                '–ö–∞—Ä–∏–Ω–∞, —Å–∏—è–π —è—Ä–∫–æ!',
                '–ü—É—Å—Ç—å –º–µ—á—Ç—ã —Å–±—ã–≤–∞—é—Ç—Å—è!',
                '–° 8 –º–∞—Ä—Ç–∞! üå∏'
            ]},
            { icon: 'üåº', name: '–Æ–ª—è', wishes: [
                '–Æ–ª–µ–Ω—å–∫–∞, —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º!',
                '–û—Å—Ç–∞–≤–∞–π—Å—è —Ç–∞–∫–æ–π –∂–µ —á—É–¥–µ—Å–Ω–æ–π!',
                '–ú–æ—Ä–µ —É–ª—ã–±–æ–∫ –∏ —Ü–≤–µ—Ç–æ–≤! üå∫'
            ]},
            { icon: 'üå∫', name: '–ú–∞—à–∞', wishes: [
                '–ú–∞—à–µ–Ω—å–∫–∞, —Å 8 –º–∞—Ä—Ç–∞!',
                '–ù–µ–∂–Ω–æ—Å—Ç–∏, —Ç–µ–ø–ª–∞ –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è!',
                '–ë—É–¥—å —Å—á–∞—Å—Ç–ª–∏–≤–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å! üíñ'
            ]},
            { icon: '‚ú®', name: '–ù–∞—Å—Ç—è', wishes: [
                '–ù–∞—Å—Ç—é—à–∞, —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º –≤–µ—Å–Ω—ã!',
                '–ü—É—Å—Ç—å –≤—Å—ë –∑–∞–¥—É–º–∞–Ω–Ω–æ–µ —Å–±—É–¥–µ—Ç—Å—è!',
                '–°–∏—è–π –∏ —Ä–∞–¥—É–π –º–∏—Ä! üå∑'
            ]}
        ];

        // ==================== –ó–ê–ü–û–õ–ù–ï–ù–ò–ï –ò–ú–Å–ù ====================
        const container = document.getElementById('namesContainer');
        namesData.forEach((item, index) => {
            const block = document.createElement('div');
            block.className = 'personal-block' + (item.special ? ' special' : '');
            block.onclick = () => openNameModal(index);
            block.setAttribute('role', 'button');
            block.setAttribute('tabindex', '0');
            block.innerHTML = `
                <div class="name-row">
                    <span class="name-icon">${item.icon}</span>
                    <span class="name-label">${item.name}</span>
                </div>
            `;
            container.appendChild(block);
        });

        // ==================== –ú–û–î–ê–õ–ö–ê –ò–ú–Å–ù ====================
        const nameModal = document.getElementById('nameModal');
        const modalNameIcon = document.getElementById('modalNameIcon');
        const modalNameTitle = document.getElementById('modalNameTitle');
        const modalWishes = document.getElementById('modalWishes');

        function openNameModal(index) {
            const data = namesData[index];
            modalNameIcon.textContent = data.icon;
            modalNameTitle.textContent = data.name;
            modalWishes.innerHTML = '';
            data.wishes.forEach(wish => {
                const div = document.createElement('div');
                div.className = 'wish-line';
                div.textContent = wish;
                modalWishes.appendChild(div);
            });
            nameModal.style.display = 'flex';
        }
        
        function closeNameModal() { nameModal.style.display = 'none'; }

        // ==================== –õ–ï–ü–ï–°–¢–ö–ò ====================
        let currentPetalCount = 25;
        function createPetals(count) {
            const frontContainer = document.getElementById('petalsFront');
            frontContainer.innerHTML = '';
            const petalsList = ['üå∏', 'üå∑', 'üåº', 'üå∫'];
            for (let i = 0; i < count; i++) {
                const petal = document.createElement('div');
                petal.className = 'petal';
                petal.textContent = petalsList[Math.floor(Math.random() * petalsList.length)];
                petal.style.left = Math.random() * 100 + '%';
                petal.style.animationDuration = (Math.random() * 8 + 8) + 's';
                petal.style.animationDelay = Math.random() * -15 + 's';
                petal.style.fontSize = (Math.random() * 1.2 + 0.9) + 'rem';
                frontContainer.appendChild(petal);
            }
        }

        function flowerRain(count = 25) {
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const flower = document.createElement('div');
                    flower.textContent = ['üå∏','üå∑','üåº','üå∫','üåπ'][Math.floor(Math.random()*5)];
                    flower.style.position = 'fixed';
                    flower.style.left = Math.random() * 100 + '%';
                    flower.style.top = '-10%';
                    flower.style.fontSize = (Math.random() * 2 + 1.5) + 'rem';
                    flower.style.zIndex = '1000';
                    flower.style.pointerEvents = 'none';
                    flower.style.animation = `fall ${Math.random()*2+2}s linear forwards`;
                    document.body.appendChild(flower);
                    setTimeout(() => flower.remove(), 3500);
                }, i * 50);
            }
        }

        // ==================== –ò–ì–†–ê –°–ß–ï–¢–ß–ò–ö ====================
        let flowerCount = 0;
        const counterElement = document.getElementById('flowerCounter');
        const clickFlower = document.getElementById('clickFlower');
        const gameHint = document.getElementById('gameHint');
        const progressBar = document.getElementById('progressBar');
        const victoryModal = document.getElementById('victoryModal');
        const victoryMessage = document.getElementById('victoryMessage');

        function updateDisplay() {
            counterElement.textContent = `üå∫ ${flowerCount}`;
            const progress = (flowerCount % 100) / 100 * 100;
            progressBar.style.width = progress + '%';
            const nextTarget = (Math.floor(flowerCount / 100) + 1) * 100;
            const toGo = nextTarget - flowerCount;
            gameHint.textContent = flowerCount > 0 ? `–î–æ ${nextTarget} —Ü–≤–µ—Ç–æ–≤: ${toGo} ‚ú®` : `–ö–ª–∏–∫–∞–π –Ω–∞ —Ü–≤–µ—Ç–æ–∫!`;
        }

        const compliments = [
            "–¢—ã —Å–µ–≥–æ–¥–Ω—è –æ—Å–ª–µ–ø–∏—Ç–µ–ª—å–Ω–∞! ‚ú®",
            "–£ —Ç–µ–±—è –ø–æ—Ç—Ä—è—Å–∞—é—â–∞—è —É–ª—ã–±–∫–∞! üòä",
            "–¢—ã ‚Äî –≤–µ—Å–µ–Ω–Ω–µ–µ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ! üåº",
            "–° —Ç–æ–±–æ–π —Ç–µ–ø–ª–æ, –∫–∞–∫ –≤ –º–∞–µ! ‚òÄÔ∏è",
            "–¢–≤–æ—è —ç–Ω–µ—Ä–≥–∏—è –∑–∞—Ä—è–∂–∞–µ—Ç! ‚ö°",
            "–¢—ã —á—É–¥–æ! üíñ",
            "–ù–µ–∂–Ω–æ—Å—Ç—å –∏ –∫—Ä–∞—Å–æ—Ç–∞ ‚Äî —ç—Ç–æ —Ç—ã! üå∏"
        ];
        
        const complimentModal = document.getElementById('complimentModal');
        const complimentMessage = document.getElementById('complimentMessage');

        function check50() {
            if (flowerCount > 0 && flowerCount % 50 === 0) {
                const randomIndex = Math.floor(Math.random() * compliments.length);
                complimentMessage.textContent = compliments[randomIndex];
                complimentModal.style.display = 'flex';
            }
        }

        function closeComplimentModal() { complimentModal.style.display = 'none'; }

        function checkVictory() {
            if (flowerCount % 100 === 0 && flowerCount > 0) {
                victoryMessage.innerHTML = `üéâ ${flowerCount} —Ü–≤–µ—Ç–æ–≤!<br>–¢—ã –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–∞! üéâ`;
                victoryModal.style.display = 'flex';
                flowerRain(25);
            }
        }

        clickFlower.addEventListener('click', function(e) {
            e.preventDefault();
            flowerCount++;
            updateDisplay();
            this.style.transform = 'scale(0.92)';
            setTimeout(() => this.style.transform = 'scale(1)', 100);
            checkVictory();
            check50();
        });

        clickFlower.addEventListener('touchstart', function(e) {
            e.preventDefault();
            this.style.transform = 'scale(0.92)';
        });

        clickFlower.addEventListener('touchend', function(e) {
            e.preventDefault();
            this.style.transform = 'scale(1)';
            flowerCount++;
            updateDisplay();
            checkVictory();
            check50();
        });

        document.getElementById('titleClick').addEventListener('click', function() {
            flowerRain(30);
        });

        document.getElementById('titleClick').addEventListener('touchstart', function(e) {
            e.preventDefault();
            flowerRain(30);
        });

        function closeVictoryModal() { victoryModal.style.display = 'none'; }

        // ==================== –ú–û–î–ê–õ–ö–ê –î–õ–Ø –°–û–û–ë–©–ï–ù–ò–ô ====================
        const messageModal = document.getElementById('messageModal');
        const messageModalText = document.getElementById('messageModalText');
        const messageModalIcon = document.getElementById('messageModalIcon');

        function showMessage(message, icon = 'üí¨') {
            messageModalText.textContent = message;
            messageModalIcon.textContent = icon;
            messageModal.style.display = 'flex';
        }

        function closeMessageModal() {
            messageModal.style.display = 'none';
        }

        // ==================== –ü–†–û–ú–û –ú–û–î–ê–õ–ö–ê ====================
        const promoModal = document.getElementById('promoModal');
        const easterEgg = document.getElementById('easterEgg');
        
        easterEgg.addEventListener('click', function() {
            promoModal.style.display = 'flex';
            document.getElementById('promoCodeInput').value = '';
        });

        easterEgg.addEventListener('touchstart', function(e) {
            e.preventDefault();
            promoModal.style.display = 'flex';
            document.getElementById('promoCodeInput').value = '';
        });

        function closePromoModal() { promoModal.style.display = 'none'; }

        document.getElementById('applyPromoCodeBtn').addEventListener('click', function() {
            const input = document.getElementById('promoCodeInput');
            const code = input.value.trim();
            let message = '';
            let icon = 'üéÅ';

            if (code === '1488') {
                flowerCount = 0;
                updateDisplay();
                message = 'üö´ –û—Å—É–∂–¥–∞—é –Ω–∞—Ü–∏–∑–º! –°—á–µ—Ç –æ–±–Ω—É–ª–µ–Ω.';
                icon = 'üö´';
            } else if (code === '52') {
                flowerCount += 5200;
                updateDisplay();
                message = '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥! ‚ú® +5200 —Ü–≤–µ—Ç–æ–≤';
                icon = 'üèõÔ∏è';
            } else if (code === '67') {
                flowerCount += 1;
                updateDisplay();
                message = '–Ω–µ —Å–º–µ—à–Ω–æ üòï +1 —Ü–≤–µ—Ç–æ–∫';
                icon = 'üòï';
            } else if (code === '1337') {
                flowerCount += 133700;
                updateDisplay();
                message = 'elite üëæ +133700 —Ü–≤–µ—Ç–æ–≤';
                icon = 'üëæ';
            } else if (code === '69') {
                flowerCount += 690;
                updateDisplay();
                message = '... üòè +690 —Ü–≤–µ—Ç–æ–≤';
                icon = 'üòè';
            } else {
                message = '–ù–µ–≤–µ—Ä–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥';
                icon = '‚ùå';
            }

            showMessage(message, icon);
            
            if (code === '1488' || code === '52' || code === '67' || code === '1337' || code === '69') {
                checkVictory();
                check50();
            }
            closePromoModal();
        });

        // ==================== –ù–ê–°–¢–†–û–ô–ö–ò ====================
        const settingsModal = document.getElementById('settingsModal');
        const settingsButton = document.getElementById('settingsButton');
        const petalSlider = document.getElementById('petalCountSlider');
        const petalCountValue = document.getElementById('petalCountValue');

        settingsButton.addEventListener('click', () => {
            settingsModal.style.display = 'flex';
        });

        settingsButton.addEventListener('touchstart', (e) => {
            e.preventDefault();
            settingsModal.style.display = 'flex';
        });

        function closeSettingsModal() {
            settingsModal.style.display = 'none';
        }

        petalSlider.addEventListener('input', (e) => {
            const val = e.target.value;
            petalCountValue.textContent = val;
            currentPetalCount = Number(val);
            createPetals(currentPetalCount);
        });

        // ==================== –ì–ê–î–ê–ù–ò–ï –ù–ê –†–û–ú–ê–®–ö–ï ====================
        const daisyModal = document.getElementById('daisyModal');
        const daisyGameBtn = document.getElementById('daisyGameBtn');
        
        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è –≥–∞–¥–∞–Ω–∏—è
        const DAISY_PHRASES = [
            "–õ—é–±–∏—Ç üíñ",
            "–ù–µ –ª—é–±–∏—Ç üñ§",
            "–ü–ª—é–Ω–µ—Ç üíß",
            "–ü–æ—Ü–µ–ª—É–µ—Ç üíã",
            "–ö —Å–µ—Ä–¥—Ü—É –ø—Ä–∏–∂–º—ë—Ç ü§ó",
            "–ö —á—ë—Ä—Ç—É –ø–æ—à–ª—ë—Ç üëø"
        ];

        let daisyTotalPetals = 12;
        let daisyVisiblePetals = 12;
        let daisyCurrentPhraseIndex = 0;
        let daisyPetalElements = [];

        function initDaisyGame() {
            daisyTotalPetals = Math.floor(Math.random() * 4) + 9;
            createDaisyPetals(daisyTotalPetals);
            setDaisyVisiblePetals(daisyTotalPetals);
            daisyCurrentPhraseIndex = Math.floor(Math.random() * DAISY_PHRASES.length);
            document.getElementById('daisyFortuneText').innerText = DAISY_PHRASES[daisyCurrentPhraseIndex];
            
            document.getElementById('daisyPluckBtn').classList.remove('hidden');
            document.getElementById('daisySpinBtn').classList.add('hidden');
            document.getElementById('daisyFlower').classList.remove('spinning');
        }

        function createDaisyPetals(maxCount) {
            const container = document.getElementById('daisyPetalsContainer');
            container.innerHTML = '';
            daisyPetalElements = [];
            
            const angleStep = 360 / maxCount;

            for (let i = 0; i < maxCount; i++) {
                const angle = angleStep * i;
                const petal = document.createElement('div');
                petal.className = 'daisy-petal';
                petal.style.transform = `translate(-50%, 0) rotate(${angle}deg)`;
                petal.style.setProperty('--rot', angle + 'deg');
                container.appendChild(petal);
                daisyPetalElements.push(petal);
            }
        }

        function setDaisyVisiblePetals(count) {
            for (let i = 0; i < daisyPetalElements.length; i++) {
                daisyPetalElements[i].style.opacity = i < count ? '1' : '0';
            }
            daisyVisiblePetals = count;
        }

        function pluckDaisyPetal() {
            if (daisyVisiblePetals <= 0) return;

            for (let i = daisyPetalElements.length - 1; i >= 0; i--) {
                if (daisyPetalElements[i].style.opacity === '1') {
                    daisyPetalElements[i].style.opacity = '0';
                    break;
                }
            }
            
            daisyVisiblePetals--;
            daisyCurrentPhraseIndex = (daisyCurrentPhraseIndex + 1) % DAISY_PHRASES.length;
            document.getElementById('daisyFortuneText').innerText = DAISY_PHRASES[daisyCurrentPhraseIndex];

            if (daisyVisiblePetals === 0) {
                showMessage(`üéâ –í–∞—à–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ: ${DAISY_PHRASES[daisyCurrentPhraseIndex]}`, 'üåº');
                document.getElementById('daisyPluckBtn').classList.add('hidden');
                document.getElementById('daisySpinBtn').classList.remove('hidden');
            }
        }

        function startDaisySpin() {
            if (daisyVisiblePetals !== 0) return;

            const spinBtn = document.getElementById('daisySpinBtn');
            const flowerEl = document.getElementById('daisyFlower');
            
            spinBtn.disabled = true;
            flowerEl.classList.add('spinning');
            document.getElementById('daisyFortuneText').innerText = 'üåÄ –í—Ä–∞—â–∞—é...';

            const targetCount = Math.floor(Math.random() * 4) + 9;
            let current = 0;
            
            const interval = setInterval(() => {
                if (!flowerEl.classList.contains('spinning')) {
                    clearInterval(interval);
                    return;
                }

                current++;
                
                for (let i = 0; i < daisyPetalElements.length; i++) {
                    daisyPetalElements[i].style.opacity = i < current ? '1' : '0';
                }

                if (current >= targetCount) {
                    clearInterval(interval);
                    setTimeout(() => {
                        if (flowerEl.classList.contains('spinning')) {
                            finishDaisySpin(targetCount);
                        }
                    }, 200);
                }
            }, 100);
        }

        function finishDaisySpin(newCount) {
            const flowerEl = document.getElementById('daisyFlower');
            flowerEl.classList.remove('spinning');
            daisyVisiblePetals = newCount;
            
            daisyCurrentPhraseIndex = Math.floor(Math.random() * DAISY_PHRASES.length);
            document.getElementById('daisyFortuneText').innerText = '‚ú® –ì–∞–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–æ ‚ú®';

            document.getElementById('daisyPluckBtn').classList.remove('hidden');
            document.getElementById('daisySpinBtn').classList.add('hidden');
            document.getElementById('daisySpinBtn').disabled = false;

            flowerRain(18);
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –≥–∞–¥–∞–Ω–∏—è
        daisyGameBtn.addEventListener('click', function() {
            if (flowerCount < 10) {
                showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ü–≤–µ—Ç–æ–≤! –ù—É–∂–Ω–æ 10 üå∏', 'üíî');
                return;
            }
            
            flowerCount -= 10;
            updateDisplay();
            initDaisyGame();
            daisyModal.style.display = 'flex';
        });

        daisyGameBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            if (flowerCount < 10) {
                showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ü–≤–µ—Ç–æ–≤! –ù—É–∂–Ω–æ 10 üå∏', 'üíî');
                return;
            }
            
            flowerCount -= 10;
            updateDisplay();
            initDaisyGame();
            daisyModal.style.display = 'flex';
        });

        function closeDaisyModal() {
            daisyModal.style.display = 'none';
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≥–∞–¥–∞–Ω–∏—è
        document.getElementById('daisyPluckBtn').addEventListener('click', pluckDaisyPetal);
        document.getElementById('daisySpinBtn').addEventListener('click', startDaisySpin);

        // ==================== –ó–ê–ö–†–´–¢–ò–ï –ú–û–î–ê–õ–û–ö ====================
        window.onclick = function(event) {
            if (event.target === nameModal) closeNameModal();
            if (event.target === victoryModal) closeVictoryModal();
            if (event.target === complimentModal) closeComplimentModal();
            if (event.target === promoModal) closePromoModal();
            if (event.target === settingsModal) closeSettingsModal();
            if (event.target === daisyModal) closeDaisyModal();
            if (event.target === messageModal) closeMessageModal();
        };

        document.querySelectorAll('.custom-modal-content').forEach(modal => {
            modal.addEventListener('touchmove', (e) => {
                e.stopPropagation();
            });
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        createPetals(currentPetalCount);
        updateDisplay();

        document.addEventListener('touchstart', (e) => {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>