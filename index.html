<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>–° 8 –º–∞—Ä—Ç–∞ ‚Äî –∏–º–µ–Ω–Ω—ã–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏</title>
    <link rel="stylesheet" href="themes/base.css">
    <link rel="stylesheet" href="themes/themes.css">
</head>
<body id="mainBody" class="theme-default">

    <div class="petals-front" id="petalsFront"></div>

    <div class="main-card">
        <div class="settings-button" id="settingsButton" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">‚öôÔ∏è</div>

        <h1 class="main-title" id="titleClick" role="button" tabindex="0">–° 8 –º–∞—Ä—Ç–∞</h1>
        <div class="soft-sub">—Å–∞–º—ã–µ –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–µ –∏ –Ω–µ–∂–Ω—ã–µ</div>

        <div class="names-wishes" id="namesContainer"></div>

        <div class="game-section">
            <div class="game-title">
                <span>üå∏</span> –°–æ–±–µ—Ä–∏ –±—É–∫–µ—Ç <span>üå∑</span>
            </div>
            <div class="clicker-area">
                <div class="counter-display" id="flowerCounter">üå∫ 0</div>
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="big-flower" id="clickFlower" role="button" tabindex="0" aria-label="–ö–ª–∏–∫–Ω–∏ —Ü–≤–µ—Ç–æ–∫">üå∏</div>
                <div class="game-hint" id="gameHint">–ö–ª–∏–∫–∞–π –Ω–∞ —Ü–≤–µ—Ç–æ–∫ ‚ú®</div>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ –º–∏–Ω–∏-–∏–≥—Ä -->
        <div class="games-row">
            <button class="game-btn daisy-btn" id="daisyGameBtn">
                <span>üåº</span> –†–æ–º–∞—à–∫–∞ (10üå∏)
            </button>
            <button class="game-btn wheel-btn" id="wheelGameBtn">
                <span>üé∞</span> –ë—É–∫–µ—Ç (10üå∏)
            </button>
        </div>

        <div class="signature" id="easterEgg" role="button" tabindex="0">
            <span>üíó</span> by Aizen with love <span>üíó</span>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–ö–ò -->
    <div id="nameModal" class="custom-modal">
        <div class="custom-modal-content">
            <div class="modal-flower" id="modalNameIcon">üå∏</div>
            <div class="modal-message" id="modalNameTitle">–ê–Ω–Ω–∞</div>
            <div id="modalWishes" class="wish-lines"></div>
            <div class="modal-btn" onclick="closeNameModal()">–°–ø–∞—Å–∏–±–æ ‚ú®</div>
        </div>
    </div>

    <div id="victoryModal" class="custom-modal">
        <div class="custom-modal-content">
            <div class="modal-flower">üå∏üå∑üå∏</div>
            <div class="modal-message" id="victoryMessage">üéâ 100 —Ü–≤–µ—Ç–æ–≤!<br>–¢—ã –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–∞! üéâ</div>
            <div class="modal-btn" onclick="closeVictoryModal()">–°–ø–∞—Å–∏–±–æ ‚ú®</div>
        </div>
    </div>

    <div id="complimentModal" class="custom-modal">
        <div class="custom-modal-content">
            <div class="modal-flower">üíê‚ú®üíê</div>
            <div class="modal-message" id="complimentMessage">–¢—ã —Å—É–ø–µ—Ä!</div>
            <div class="modal-btn" onclick="closeComplimentModal()">üå∏ –°–ø–∞—Å–∏–±–æ</div>
        </div>
    </div>

    <div id="promoModal" class="custom-modal">
        <div class="custom-modal-content">
            <div class="modal-flower">üéÅüíóüéÅ</div>
            <div class="modal-message">–ù–∞–¥–µ—é—Å—å, –≤—ã –º–µ–Ω—è –Ω–µ –Ω–µ–Ω–∞–≤–∏–¥–∏—Ç–µ)<br>–í–æ—Ç –≤–∞–º –ø–æ–¥–∞—Ä–æ–∫ - –≤–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥<br><span style="font-size:1.3rem;">(–ü–æ–¥—Å–∫–∞–∑–∫–∞: —ç—Ç–æ –º–µ–º–Ω–æ–µ —á–∏—Å–ª–æ)</span></div>
            <input type="text" id="promoCodeInput" class="promo-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä 1488" maxlength="10" inputmode="numeric">
            <div class="modal-btn" id="applyPromoCodeBtn">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</div>
            <div class="modal-btn" onclick="closePromoModal()" style="margin-top:8px; background:#ffe2ed;">–ó–∞–∫—Ä—ã—Ç—å</div>
        </div>
    </div>

    <div id="settingsModal" class="custom-modal settings-modal">
        <div class="custom-modal-content">
            <div class="modal-flower">‚öôÔ∏èüå∏‚öôÔ∏è</div>
            <div class="modal-message">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            
            <div class="settings-section">
                <div class="section-title">üå∏ –õ–µ–ø–µ—Å—Ç–∫–∏</div>
                <div class="slider-row">
                    <label for="petalCountSlider">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–µ–ø–µ—Å—Ç–∫–æ–≤: <span id="petalCountValue">25</span></label>
                    <input type="range" id="petalCountSlider" min="0" max="150" value="25" step="1">
                </div>
            </div>
            
            <div class="settings-section">
                <div class="section-title">üé® –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</div>
                <div class="theme-buttons" id="themeButtons">
                    <button class="theme-btn theme-default-btn active" onclick="setTheme('default')">
                        <span class="theme-color default-color"></span>
                        –†–æ–∑–æ–≤–∞—è
                    </button>
                    <button class="theme-btn theme-white-btn" onclick="setTheme('white')">
                        <span class="theme-color white-color"></span>
                        –ë–µ–ª–∞—è
                    </button>
                    <button class="theme-btn theme-lilac-btn" onclick="setTheme('lilac')">
                        <span class="theme-color lilac-color"></span>
                        –°–∏—Ä–µ–Ω–µ–≤–∞—è
                    </button>
                    <button class="theme-btn theme-bright-pink-btn" onclick="setTheme('bright-pink')">
                        <span class="theme-color bright-pink-color"></span>
                        –Ø—Ä–∫–æ-—Ä–æ–∑–æ–≤–∞—è
                    </button>
                    <!-- –°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ–º—ã (–±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –ø–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏) -->
                    <button class="theme-btn theme-cosmic-btn hidden" onclick="setTheme('cosmic')">
                        <span class="theme-color cosmic-color"></span>
                        –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è üåü
                    </button>
                    <button class="theme-btn theme-dark-blue-btn hidden" onclick="setTheme('dark-blue')">
                        <span class="theme-color dark-blue-color"></span>
                        –¢–µ–º–Ω–æ-—Å–∏–Ω—è—è üåå
                    </button>
                </div>
            </div>
            
            <div class="about-dev">
                üíª –û —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö
            </div>
            <div class="dev-links">
                <div>‚úèÔ∏è –ê–≤—Ç–æ—Ä: <a href="https://t.me/su57ks" target="_blank" rel="noopener">@su57ks</a></div>
                <div>üí° –ò–¥–µ–∏: <a href="https://t.me/selyswag" target="_blank" rel="noopener">@selyswag</a></div>
                <div>üß™ –¢–µ—Å—Ç–µ—Ä: –Ø—Ä–æ—Å–ª–∞–≤–∞</div>
                <div class="thanks">üôè –°–ø–∞—Å–∏–±–æ –ï–≥–æ—Ä—É –ï. –∏ –î–µ–Ω–∏—Å—É –°.</div>
            </div>
            <div class="modal-btn" onclick="closeSettingsModal()">–ó–∞–∫—Ä—ã—Ç—å</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –≥–∞–¥–∞–Ω–∏—è –Ω–∞ —Ä–æ–º–∞—à–∫–µ -->
    <div id="daisyModal" class="custom-modal daisy-modal">
        <div class="custom-modal-content daisy-content">
            <div class="modal-flower">üåºüåºüåº</div>
            <div class="modal-message">–ì–∞–¥–∞–Ω–∏–µ –Ω–∞ —Ä–æ–º–∞—à–∫–µ</div>
            
            <div class="daisy-game-container">
                <div class="daisy" id="daisyGame">
                    <div class="flower" id="daisyFlower">
                        <div class="center"></div>
                        <div class="petals-container" id="daisyPetalsContainer"></div>
                    </div>
                </div>
                
                <div class="daisy-fortune" id="daisyFortuneText">üå∏ –ù–∞–∂–º–∏ "–û—Ç–æ—Ä–≤–∞—Ç—å"</div>
                
                <div class="daisy-controls">
                    <button class="daisy-btn" id="daisyPluckBtn">üå∏ –û—Ç–æ—Ä–≤–∞—Ç—å</button>
                    <button class="daisy-btn daisy-spin-btn hidden" id="daisySpinBtn">üåÄ –ì–∞–¥–∞—Ç—å</button>
                </div>
            </div>
            
            <div class="modal-btn daisy-close-btn" onclick="closeDaisyModal()">–ó–∞–∫—Ä—ã—Ç—å</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ —Ä—É–ª–µ—Ç–∫–∏ "–ë—É–∫–µ—Ç" -->
    <div id="wheelModal" class="custom-modal wheel-modal">
        <div class="custom-modal-content wheel-content">
            <div class="modal-flower">üé∞üå∏üé∞</div>
            <div class="modal-message">–ö—Ä—É—Ç–∏ —Ä—É–ª–µ—Ç–∫—É</div>
            
            <div class="wheel-game-container">
                <div class="wheel-wrapper">
                    <div class="pointer"></div>
                    <canvas id="wheelCanvas" width="600" height="600"></canvas>
                </div>
                <button class="wheel-spin-btn" id="wheelSpinBtn">üé∞ –ö—Ä—É—Ç–∏—Ç—å (10üå∏)</button>
            </div>
            
            <div class="modal-btn wheel-close-btn" onclick="closeWheelModal()">–ó–∞–∫—Ä—ã—Ç—å</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π (–∑–∞–º–µ–Ω–∞ alert) -->
    <div id="messageModal" class="custom-modal message-modal">
        <div class="custom-modal-content message-content">
            <div class="modal-flower" id="messageModalIcon">üí¨</div>
            <div class="modal-message" id="messageModalText">–°–æ–æ–±—â–µ–Ω–∏–µ</div>
            <div class="modal-btn" onclick="closeMessageModal()">OK</div>
        </div>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ü–≤–µ—Ç–æ–ø–∞–¥–∞ (–ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ) -->
    <div class="rain-container" id="rainContainer"></div>

    <script>
        // ==================== –î–ê–ù–ù–´–ï –ò–ú–Å–ù ====================
        const namesData = [
            { icon: 'üå∏', name: '–û–ª—å–≥–∞ –ù–∏–∫–æ–ª–∞–µ–≤–Ω–∞', special: true, wishes: [
                '–° 8 –º–∞—Ä—Ç–∞, –û–ª—å–≥–∞ –ù–∏–∫–æ–ª–∞–µ–≤–Ω–∞!',
                '–í—ã ‚Äî —Å–∞–º—ã–π –ª—É—á—à–∏–π –∫–ª–∞—Å—Å–Ω—ã–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å!',
                '–ó–¥–æ—Ä–æ–≤—å—è, —Å—á–∞—Å—Ç—å—è –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è!',
                '–ü—É—Å—Ç—å —É—á–µ–Ω–∏–∫–∏ —Ä–∞–¥—É—é—Ç –∫–∞–∂–¥—ã–π –¥–µ–Ω—å! üíê'
            ]},
            { icon: 'üå∑', name: '–õ—É–∫–µ—Ä—å—è', wishes: [
                '–ù–µ–∂–Ω–∞—è –õ—É–∫–µ—Ä—å—è, —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º!',
                '–ü—É—Å—Ç—å –≤–µ—Å–Ω–∞ –ø–æ–¥–∞—Ä–∏—Ç –º–Ω–æ–≥–æ —Ü–≤–µ—Ç–æ–≤!',
                '–°—á–∞—Å—Ç—å—è, –ª—é–±–≤–∏ –∏ –∫—Ä–∞—Å–æ—Ç—ã! ‚ú®'
            ]},
            { icon: 'üå∏', name: '–ö–∞—Ä–∏–Ω–∞', wishes: [
                '–ö–∞—Ä–∏–Ω–∞, —Å–∏—è–π —è—Ä–∫–æ!',
                '–ü—É—Å—Ç—å –º–µ—á—Ç—ã —Å–±—ã–≤–∞—é—Ç—Å—è!',
                '–° 8 –º–∞—Ä—Ç–∞! üå∏'
            ]},
            { icon: 'üåº', name: '–Æ–ª—è', wishes: [
                '–Æ–ª–µ–Ω—å–∫–∞, —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º!',
                '–û—Å—Ç–∞–≤–∞–π—Å—è —Ç–∞–∫–æ–π –∂–µ —á—É–¥–µ—Å–Ω–æ–π!',
                '–ú–æ—Ä–µ —É–ª—ã–±–æ–∫ –∏ —Ü–≤–µ—Ç–æ–≤! üå∫'
            ]},
            { icon: 'üå∫', name: '–ú–∞—à–∞', wishes: [
                '–ú–∞—à–µ–Ω—å–∫–∞, —Å 8 –º–∞—Ä—Ç–∞!',
                '–ù–µ–∂–Ω–æ—Å—Ç–∏, —Ç–µ–ø–ª–∞ –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è!',
                '–ë—É–¥—å —Å—á–∞—Å—Ç–ª–∏–≤–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å! üíñ'
            ]},
            { icon: '‚ú®', name: '–ù–∞—Å—Ç—è', wishes: [
                '–ù–∞—Å—Ç—é—à–∞, —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º –≤–µ—Å–Ω—ã!',
                '–ü—É—Å—Ç—å –≤—Å—ë –∑–∞–¥—É–º–∞–Ω–Ω–æ–µ —Å–±—É–¥–µ—Ç—Å—è!',
                '–°–∏—è–π –∏ —Ä–∞–¥—É–π –º–∏—Ä! üå∑'
            ]}
        ];

        // ==================== –ó–ê–ü–û–õ–ù–ï–ù–ò–ï –ò–ú–Å–ù ====================
        const container = document.getElementById('namesContainer');
        namesData.forEach((item, index) => {
            const block = document.createElement('div');
            block.className = 'personal-block' + (item.special ? ' special' : '');
            block.onclick = () => openNameModal(index);
            block.setAttribute('role', 'button');
            block.setAttribute('tabindex', '0');
            block.innerHTML = `
                <div class="name-row">
                    <span class="name-icon">${item.icon}</span>
                    <span class="name-label">${item.name}</span>
                </div>
            `;
            container.appendChild(block);
        });

        // ==================== –ú–û–î–ê–õ–ö–ê –ò–ú–Å–ù ====================
        const nameModal = document.getElementById('nameModal');
        const modalNameIcon = document.getElementById('modalNameIcon');
        const modalNameTitle = document.getElementById('modalNameTitle');
        const modalWishes = document.getElementById('modalWishes');

        function openNameModal(index) {
            const data = namesData[index];
            modalNameIcon.textContent = data.icon;
            modalNameTitle.textContent = data.name;
            modalWishes.innerHTML = '';
            data.wishes.forEach(wish => {
                const div = document.createElement('div');
                div.className = 'wish-line';
                div.textContent = wish;
                modalWishes.appendChild(div);
            });
            nameModal.style.display = 'flex';
        }
        
        function closeNameModal() { nameModal.style.display = 'none'; }

        // ==================== –õ–ï–ü–ï–°–¢–ö–ò ====================
        let currentPetalCount = 25;
        function createPetals(count) {
            const frontContainer = document.getElementById('petalsFront');
            frontContainer.innerHTML = '';
            const petalsList = ['üå∏', 'üå∑', 'üåº', 'üå∫'];
            for (let i = 0; i < count; i++) {
                const petal = document.createElement('div');
                petal.className = 'petal';
                petal.textContent = petalsList[Math.floor(Math.random() * petalsList.length)];
                petal.style.left = Math.random() * 100 + '%';
                petal.style.animationDuration = (Math.random() * 8 + 8) + 's';
                petal.style.animationDelay = Math.random() * -15 + 's';
                petal.style.fontSize = (Math.random() * 1.2 + 0.9) + 'rem';
                frontContainer.appendChild(petal);
            }
        }

        function flowerRain(count = 25, specificEmoji = null) {
            const rainContainer = document.getElementById('rainContainer');
            const flowersList = ['üå∏', 'üå∑', 'üåº', 'üå∫', 'üåπ', 'üåª', 'üåø'];
            
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const flower = document.createElement('div');
                    flower.className = 'falling-flower';
                    
                    if (specificEmoji && Math.random() < 0.8) {
                        flower.textContent = specificEmoji;
                    } else {
                        flower.textContent = flowersList[Math.floor(Math.random() * flowersList.length)];
                    }
                    
                    flower.style.left = Math.random() * 100 + '%';
                    flower.style.animationDuration = (Math.random() * 3 + 2.5) + 's';
                    flower.style.fontSize = (Math.random() * 2 + 1.8) + 'rem';
                    flower.style.opacity = 0.7 + Math.random() * 0.3;
                    rainContainer.appendChild(flower);

                    setTimeout(() => {
                        if (flower.parentNode) flower.remove();
                    }, 6000);
                }, i * 30);
            }
        }

        // ==================== –ò–ì–†–ê –°–ß–ï–¢–ß–ò–ö ====================
        let flowerCount = 0;
        const counterElement = document.getElementById('flowerCounter');
        const clickFlower = document.getElementById('clickFlower');
        const gameHint = document.getElementById('gameHint');
        const progressBar = document.getElementById('progressBar');
        const victoryModal = document.getElementById('victoryModal');
        const victoryMessage = document.getElementById('victoryMessage');

        function updateDisplay() {
            counterElement.textContent = `üå∫ ${flowerCount}`;
            const progress = (flowerCount % 100) / 100 * 100;
            progressBar.style.width = progress + '%';
            const nextTarget = (Math.floor(flowerCount / 100) + 1) * 100;
            const toGo = nextTarget - flowerCount;
            gameHint.textContent = flowerCount > 0 ? `–î–æ ${nextTarget} —Ü–≤–µ—Ç–æ–≤: ${toGo} ‚ú®` : `–ö–ª–∏–∫–∞–π –Ω–∞ —Ü–≤–µ—Ç–æ–∫!`;
        }

        const compliments = [
            "–¢—ã —Å–µ–≥–æ–¥–Ω—è –æ—Å–ª–µ–ø–∏—Ç–µ–ª—å–Ω–∞! ‚ú®",
            "–£ —Ç–µ–±—è –ø–æ—Ç—Ä—è—Å–∞—é—â–∞—è —É–ª—ã–±–∫–∞! üòä",
            "–¢—ã ‚Äî –≤–µ—Å–µ–Ω–Ω–µ–µ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ! üåº",
            "–° —Ç–æ–±–æ–π —Ç–µ–ø–ª–æ, –∫–∞–∫ –≤ –º–∞–µ! ‚òÄÔ∏è",
            "–¢–≤–æ—è —ç–Ω–µ—Ä–≥–∏—è –∑–∞—Ä—è–∂–∞–µ—Ç! ‚ö°",
            "–¢—ã —á—É–¥–æ! üíñ",
            "–ù–µ–∂–Ω–æ—Å—Ç—å –∏ –∫—Ä–∞—Å–æ—Ç–∞ ‚Äî —ç—Ç–æ —Ç—ã! üå∏"
        ];
        
        const complimentModal = document.getElementById('complimentModal');
        const complimentMessage = document.getElementById('complimentMessage');

        function check50() {
            if (flowerCount > 0 && flowerCount % 50 === 0) {
                const randomIndex = Math.floor(Math.random() * compliments.length);
                complimentMessage.textContent = compliments[randomIndex];
                complimentModal.style.display = 'flex';
            }
        }

        function closeComplimentModal() { complimentModal.style.display = 'none'; }

        function checkVictory() {
            if (flowerCount % 100 === 0 && flowerCount > 0) {
                victoryMessage.innerHTML = `üéâ ${flowerCount} —Ü–≤–µ—Ç–æ–≤!<br>–¢—ã –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–∞! üéâ`;
                victoryModal.style.display = 'flex';
                flowerRain(25);
            }
        }

        clickFlower.addEventListener('click', function(e) {
            e.preventDefault();
            flowerCount++;
            updateDisplay();
            this.style.transform = 'scale(0.92)';
            setTimeout(() => this.style.transform = 'scale(1)', 100);
            checkVictory();
            check50();
        });

        clickFlower.addEventListener('touchstart', function(e) {
            e.preventDefault();
            this.style.transform = 'scale(0.92)';
        });

        clickFlower.addEventListener('touchend', function(e) {
            e.preventDefault();
            this.style.transform = 'scale(1)';
            flowerCount++;
            updateDisplay();
            checkVictory();
            check50();
        });

        document.getElementById('titleClick').addEventListener('click', function() {
            flowerRain(30);
        });

        document.getElementById('titleClick').addEventListener('touchstart', function(e) {
            e.preventDefault();
            flowerRain(30);
        });

        function closeVictoryModal() { victoryModal.style.display = 'none'; }

        // ==================== –ú–û–î–ê–õ–ö–ê –î–õ–Ø –°–û–û–ë–©–ï–ù–ò–ô ====================
        const messageModal = document.getElementById('messageModal');
        const messageModalText = document.getElementById('messageModalText');
        const messageModalIcon = document.getElementById('messageModalIcon');

        function showMessage(message, icon = 'üí¨') {
            messageModalText.textContent = message;
            messageModalIcon.textContent = icon;
            messageModal.style.display = 'flex';
        }

        function closeMessageModal() {
            messageModal.style.display = 'none';
        }

        // ==================== –ü–†–û–ú–û –ú–û–î–ê–õ–ö–ê ====================
        const promoModal = document.getElementById('promoModal');
        const easterEgg = document.getElementById('easterEgg');
        
        easterEgg.addEventListener('click', function() {
            promoModal.style.display = 'flex';
            document.getElementById('promoCodeInput').value = '';
        });

        easterEgg.addEventListener('touchstart', function(e) {
            e.preventDefault();
            promoModal.style.display = 'flex';
            document.getElementById('promoCodeInput').value = '';
        });

        function closePromoModal() { promoModal.style.display = 'none'; }

        // –§–ª–∞–≥–∏ –¥–ª—è —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–µ–º
        let cosmicThemeUnlocked = false;
        let darkBlueThemeUnlocked = false;

        document.getElementById('applyPromoCodeBtn').addEventListener('click', function() {
            const input = document.getElementById('promoCodeInput');
            const code = input.value.trim();
            let message = '';
            let icon = 'üéÅ';

            if (code === '1488') {
                flowerCount = 0;
                updateDisplay();
                message = 'üö´ –û—Å—É–∂–¥–∞—é –Ω–∞—Ü–∏–∑–º! –°—á–µ—Ç –æ–±–Ω—É–ª–µ–Ω.';
                icon = 'üö´';
            } else if (code === '52') {
                flowerCount += 5200;
                updateDisplay();
                message = '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥! ‚ú® +5200 —Ü–≤–µ—Ç–æ–≤';
                icon = 'üèõÔ∏è';
            } else if (code === '67') {
                flowerCount += 1;
                updateDisplay();
                message = '–Ω–µ —Å–º–µ—à–Ω–æ üòï +1 —Ü–≤–µ—Ç–æ–∫';
                icon = 'üòï';
            } else if (code === '1337') {
                flowerCount += 133700;
                updateDisplay();
                message = 'elite üëæ +133700 —Ü–≤–µ—Ç–æ–≤';
                icon = 'üëæ';
                
                // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç–µ–º–Ω–æ-—Å–∏–Ω–µ–π —Ç–µ–º—ã
                if (!darkBlueThemeUnlocked) {
                    darkBlueThemeUnlocked = true;
                    document.querySelector('.theme-dark-blue-btn').classList.remove('hidden');
                    showMessage('üéâ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –¢–µ–º–Ω–æ-—Å–∏–Ω—è—è —Ç–µ–º–∞!', 'üåå');
                }
            } else if (code === '69') {
                flowerCount += 690;
                updateDisplay();
                message = '... üòè +690 —Ü–≤–µ—Ç–æ–≤';
                icon = 'üòè';
            } else if (code === '505') {
                flowerCount += 505812;
                updateDisplay();
                message = 'üî• +505812 —Ü–≤–µ—Ç–æ–≤! –û–≥–æ! üî•';
                icon = 'üåü';
                
                // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–π —Ç–µ–º—ã
                if (!cosmicThemeUnlocked) {
                    cosmicThemeUnlocked = true;
                    document.querySelector('.theme-cosmic-btn').classList.remove('hidden');
                    showMessage('üéâ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Ç–µ–º–∞!', 'üåü');
                }
            } else {
                message = '–ù–µ–≤–µ—Ä–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥';
                icon = '‚ùå';
            }

            showMessage(message, icon);
            
            if (code === '1488' || code === '52' || code === '67' || code === '1337' || code === '69' || code === '505') {
                checkVictory();
                check50();
            }
            closePromoModal();
        });

        // ==================== –ù–ê–°–¢–†–û–ô–ö–ò ====================
        const settingsModal = document.getElementById('settingsModal');
        const settingsButton = document.getElementById('settingsButton');
        const petalSlider = document.getElementById('petalCountSlider');
        const petalCountValue = document.getElementById('petalCountValue');

        settingsButton.addEventListener('click', () => {
            settingsModal.style.display = 'flex';
        });

        settingsButton.addEventListener('touchstart', (e) => {
            e.preventDefault();
            settingsModal.style.display = 'flex';
        });

        function closeSettingsModal() {
            settingsModal.style.display = 'none';
        }

        petalSlider.addEventListener('input', (e) => {
            const val = e.target.value;
            petalCountValue.textContent = val;
            currentPetalCount = Number(val);
            createPetals(currentPetalCount);
        });

        // ==================== –°–ú–ï–ù–ê –¢–ï–ú–´ ====================
        function setTheme(themeName) {
            const body = document.getElementById('mainBody');
            
            // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã —Ç–µ–º
            body.classList.remove(
                'theme-default', 'theme-white', 'theme-lilac', 'theme-bright-pink',
                'theme-cosmic', 'theme-dark-blue'
            );
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ç–µ–º—É
            body.classList.add(`theme-${themeName}`);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ù–∞—Ö–æ–¥–∏–º –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω—É–∂–Ω—É—é –∫–Ω–æ–ø–∫—É
            const activeBtn = document.querySelector(`.theme-${themeName}-btn`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –ª–µ–ø–µ—Å—Ç–∫–∏ (—á—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–æ–≤—ã–µ —Ü–≤–µ—Ç–∞)
            createPetals(currentPetalCount);
        }

        // ==================== –ì–ê–î–ê–ù–ò–ï –ù–ê –†–û–ú–ê–®–ö–ï ====================
        const daisyModal = document.getElementById('daisyModal');
        const daisyGameBtn = document.getElementById('daisyGameBtn');
        
        const DAISY_PHRASES = [
            "–õ—é–±–∏—Ç üíñ",
            "–ù–µ –ª—é–±–∏—Ç üñ§",
            "–ü–ª—é–Ω–µ—Ç üíß",
            "–ü–æ—Ü–µ–ª—É–µ—Ç üíã",
            "–ö —Å–µ—Ä–¥—Ü—É –ø—Ä–∏–∂–º—ë—Ç ü§ó",
            "–ö —á—ë—Ä—Ç—É –ø–æ—à–ª—ë—Ç üëø"
        ];

        let daisyTotalPetals = 12;
        let daisyVisiblePetals = 12;
        let daisyCurrentPhraseIndex = 0;
        let daisyPetalElements = [];

        function initDaisyGame() {
            daisyTotalPetals = Math.floor(Math.random() * 4) + 9;
            createDaisyPetals(daisyTotalPetals);
            setDaisyVisiblePetals(daisyTotalPetals);
            daisyCurrentPhraseIndex = Math.floor(Math.random() * DAISY_PHRASES.length);
            document.getElementById('daisyFortuneText').innerText = DAISY_PHRASES[daisyCurrentPhraseIndex];
            
            document.getElementById('daisyPluckBtn').classList.remove('hidden');
            document.getElementById('daisySpinBtn').classList.add('hidden');
            document.getElementById('daisyFlower').classList.remove('spinning');
        }

        function createDaisyPetals(maxCount) {
            const container = document.getElementById('daisyPetalsContainer');
            container.innerHTML = '';
            daisyPetalElements = [];
            
            const angleStep = 360 / maxCount;

            for (let i = 0; i < maxCount; i++) {
                const angle = angleStep * i;
                const petal = document.createElement('div');
                petal.className = 'daisy-petal';
                petal.style.transform = `translate(-50%, 0) rotate(${angle}deg)`;
                petal.style.setProperty('--rot', angle + 'deg');
                container.appendChild(petal);
                daisyPetalElements.push(petal);
            }
        }

        function setDaisyVisiblePetals(count) {
            for (let i = 0; i < daisyPetalElements.length; i++) {
                daisyPetalElements[i].style.opacity = i < count ? '1' : '0';
            }
            daisyVisiblePetals = count;
        }

        function pluckDaisyPetal() {
            if (daisyVisiblePetals <= 0) return;

            for (let i = daisyPetalElements.length - 1; i >= 0; i--) {
                if (daisyPetalElements[i].style.opacity === '1') {
                    daisyPetalElements[i].style.opacity = '0';
                    break;
                }
            }
            
            daisyVisiblePetals--;
            daisyCurrentPhraseIndex = (daisyCurrentPhraseIndex + 1) % DAISY_PHRASES.length;
            document.getElementById('daisyFortuneText').innerText = DAISY_PHRASES[daisyCurrentPhraseIndex];

            if (daisyVisiblePetals === 0) {
                showMessage(`üéâ –í–∞—à–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ: ${DAISY_PHRASES[daisyCurrentPhraseIndex]}`, 'üåº');
                document.getElementById('daisyPluckBtn').classList.add('hidden');
                document.getElementById('daisySpinBtn').classList.remove('hidden');
            }
        }

        function startDaisySpin() {
            if (daisyVisiblePetals !== 0) return;

            const spinBtn = document.getElementById('daisySpinBtn');
            const flowerEl = document.getElementById('daisyFlower');
            
            spinBtn.disabled = true;
            flowerEl.classList.add('spinning');
            document.getElementById('daisyFortuneText').innerText = 'üåÄ –í—Ä–∞—â–∞—é...';

            const targetCount = Math.floor(Math.random() * 4) + 9;
            let current = 0;
            
            const interval = setInterval(() => {
                if (!flowerEl.classList.contains('spinning')) {
                    clearInterval(interval);
                    return;
                }

                current++;
                
                for (let i = 0; i < daisyPetalElements.length; i++) {
                    daisyPetalElements[i].style.opacity = i < current ? '1' : '0';
                }

                if (current >= targetCount) {
                    clearInterval(interval);
                    setTimeout(() => {
                        if (flowerEl.classList.contains('spinning')) {
                            finishDaisySpin(targetCount);
                        }
                    }, 200);
                }
            }, 100);
        }

        function finishDaisySpin(newCount) {
            const flowerEl = document.getElementById('daisyFlower');
            flowerEl.classList.remove('spinning');
            daisyVisiblePetals = newCount;
            
            daisyCurrentPhraseIndex = Math.floor(Math.random() * DAISY_PHRASES.length);
            document.getElementById('daisyFortuneText').innerText = '‚ú® –ì–∞–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–æ ‚ú®';

            document.getElementById('daisyPluckBtn').classList.remove('hidden');
            document.getElementById('daisySpinBtn').classList.add('hidden');
            document.getElementById('daisySpinBtn').disabled = false;

            flowerRain(18);
        }

        daisyGameBtn.addEventListener('click', function() {
            if (flowerCount < 10) {
                showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ü–≤–µ—Ç–æ–≤! –ù—É–∂–Ω–æ 10 üå∏', 'üíî');
                return;
            }
            
            flowerCount -= 10;
            updateDisplay();
            initDaisyGame();
            daisyModal.style.display = 'flex';
        });

        daisyGameBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            if (flowerCount < 10) {
                showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ü–≤–µ—Ç–æ–≤! –ù—É–∂–Ω–æ 10 üå∏', 'üíî');
                return;
            }
            
            flowerCount -= 10;
            updateDisplay();
            initDaisyGame();
            daisyModal.style.display = 'flex';
        });

        function closeDaisyModal() {
            daisyModal.style.display = 'none';
        }

        document.getElementById('daisyPluckBtn').addEventListener('click', pluckDaisyPetal);
        document.getElementById('daisySpinBtn').addEventListener('click', startDaisySpin);

        // ==================== –†–£–õ–ï–¢–ö–ê "–ë–£–ö–ï–¢" ====================
        const wheelModal = document.getElementById('wheelModal');
        const wheelGameBtn = document.getElementById('wheelGameBtn');
        const wheelSpinBtn = document.getElementById('wheelSpinBtn');
        
        const WHEEL_FLOWERS = [
            { emoji: 'üå∏', name: '–°–∞–∫—É—Ä–∞' },
            { emoji: 'üåº', name: '–†–æ–º–∞—à–∫–∞' },
            { emoji: 'üåª', name: '–ü–æ–¥—Å–æ–ª–Ω—É—Ö' },
            { emoji: 'üå∫', name: '–ì–∏–±–∏—Å–∫—É—Å' },
            { emoji: 'üå∑', name: '–¢—é–ª—å–ø–∞–Ω' },
            { emoji: 'üåπ', name: '–†–æ–∑–∞' },
            { emoji: 'üå∏', name: '–°–∞–∫—É—Ä–∞' },
            { emoji: 'üåø', name: '–í–µ—Ç–æ—á–∫–∞' }
        ];
        
        const wheelSectorCount = 8;
        let wheelCanvas = document.getElementById('wheelCanvas');
        let wheelCtx = wheelCanvas.getContext('2d');
        let wheelRotation = 0;
        let wheelIsSpinning = false;
        let wheelAnimFrame = null;
        let wheelVelocity = 0;
        const wheelFriction = 0.985;
        const wheelMinSpin = 0.005;

        function drawWheel(rotation) {
            wheelCtx.clearRect(0, 0, wheelCanvas.width, wheelCanvas.height);
            const centerX = wheelCanvas.width / 2;
            const centerY = wheelCanvas.height / 2;
            const radius = wheelCanvas.width * 0.42;
            const angleStep = (Math.PI * 2) / wheelSectorCount;

            for (let i = 0; i < wheelSectorCount; i++) {
                const start = i * angleStep + rotation;
                const end = start + angleStep;

                wheelCtx.fillStyle = (i % 2 === 0) ? '#ffd9e6' : '#ffe4f0';
                wheelCtx.beginPath();
                wheelCtx.moveTo(centerX, centerY);
                wheelCtx.arc(centerX, centerY, radius, start, end);
                wheelCtx.closePath();
                wheelCtx.fill();

                wheelCtx.strokeStyle = '#ffffff';
                wheelCtx.lineWidth = 2.5;
                wheelCtx.beginPath();
                wheelCtx.moveTo(centerX, centerY);
                wheelCtx.arc(centerX, centerY, radius, start, end);
                wheelCtx.lineTo(centerX, centerY);
                wheelCtx.stroke();

                wheelCtx.save();
                wheelCtx.translate(centerX, centerY);
                const midAngle = start + angleStep / 2;
                wheelCtx.rotate(midAngle);
                
                const textRadius = radius * 0.7;
                wheelCtx.font = `500 ${radius * 0.45}px 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', sans-serif`;
                wheelCtx.fillStyle = '#9f5f74';
                wheelCtx.shadowColor = '#ffb7c5';
                wheelCtx.shadowBlur = 12;
                wheelCtx.textAlign = 'center';
                wheelCtx.textBaseline = 'middle';
                wheelCtx.fillText(WHEEL_FLOWERS[i].emoji, textRadius, 0);
                
                wheelCtx.restore();
            }

            wheelCtx.beginPath();
            wheelCtx.arc(centerX, centerY, 14, 0, 2 * Math.PI);
            wheelCtx.fillStyle = '#ffffff';
            wheelCtx.shadowBlur = 16;
            wheelCtx.shadowColor = '#ffb0c0';
            wheelCtx.fill();
            wheelCtx.shadowBlur = 0;
            wheelCtx.strokeStyle = '#ffb7c5';
            wheelCtx.lineWidth = 3;
            wheelCtx.stroke();
        }

        function spinWheelAnimation() {
            if (!wheelIsSpinning) return;

            wheelVelocity *= wheelFriction;
            wheelRotation += wheelVelocity;
            drawWheel(wheelRotation);

            if (Math.abs(wheelVelocity) > wheelMinSpin) {
                wheelAnimFrame = requestAnimationFrame(spinWheelAnimation);
            } else {
                wheelIsSpinning = false;
                if (wheelAnimFrame) {
                    cancelAnimationFrame(wheelAnimFrame);
                    wheelAnimFrame = null;
                }

                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—Ä–∞—â–µ–Ω–∏—è
                wheelSpinBtn.disabled = false;
                wheelCanvas.style.pointerEvents = 'auto';

                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—ã–ø–∞–≤—à–∏–π —Ü–≤–µ—Ç–æ–∫
                let norm = (wheelRotation % (2 * Math.PI) + 2 * Math.PI) % (2 * Math.PI);
                const upAngle = (3 * Math.PI) / 2;
                let localUp = upAngle - norm;
                localUp = (localUp % (2 * Math.PI) + 2 * Math.PI) % (2 * Math.PI);
                const angleStep = (2 * Math.PI) / wheelSectorCount;
                let index = Math.floor(localUp / angleStep);
                if (index >= wheelSectorCount) index = wheelSectorCount - 1;

                const result = WHEEL_FLOWERS[index];
                
                // –¶–≤–µ—Ç–æ–ø–∞–¥ –∏–∑ 100 —Ç–∞–∫–∏—Ö —Ü–≤–µ—Ç–∫–æ–≤
                flowerRain(100, result.emoji);
            }
        }

        function startWheelSpin() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —Ü–≤–µ—Ç–æ–≤ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –≤—Ä–∞—â–µ–Ω–∏–µ–º
            if (flowerCount < 10) {
                showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ü–≤–µ—Ç–æ–≤! –ù—É–∂–Ω–æ 10 üå∏', 'üíî');
                closeWheelModal();
                return;
            }
            
            if (wheelIsSpinning) return;

            // –°–ø–∏—Å—ã–≤–∞–µ–º —Ü–≤–µ—Ç—ã
            flowerCount -= 10;
            updateDisplay();

            wheelIsSpinning = true;
            wheelSpinBtn.disabled = true;
            wheelCanvas.style.pointerEvents = 'none';
            
            const targetFull = 10 * Math.PI;
            const randomAdd = Math.random() * 2 * Math.PI;
            const totalAngle = targetFull + randomAdd;
            wheelVelocity = totalAngle * (1 - wheelFriction) * 1.2;

            if (wheelAnimFrame) cancelAnimationFrame(wheelAnimFrame);
            wheelAnimFrame = requestAnimationFrame(spinWheelAnimation);
        }

        wheelGameBtn.addEventListener('click', function() {
            if (flowerCount < 10) {
                showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ü–≤–µ—Ç–æ–≤! –ù—É–∂–Ω–æ 10 üå∏', 'üíî');
                return;
            }
            
            // –ù–µ —Å–ø–∏—Å—ã–≤–∞–µ–º —Ü–≤–µ—Ç—ã –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª–∫–∏, —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—Ä–∞—â–µ–Ω–∏–∏
            drawWheel(wheelRotation);
            wheelModal.style.display = 'flex';
            wheelSpinBtn.disabled = false;
            wheelCanvas.style.pointerEvents = 'auto';
        });

        wheelGameBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            if (flowerCount < 10) {
                showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ü–≤–µ—Ç–æ–≤! –ù—É–∂–Ω–æ 10 üå∏', 'üíî');
                return;
            }
            
            drawWheel(wheelRotation);
            wheelModal.style.display = 'flex';
            wheelSpinBtn.disabled = false;
            wheelCanvas.style.pointerEvents = 'auto';
        });

        function closeWheelModal() {
            wheelModal.style.display = 'none';
        }

        wheelSpinBtn.addEventListener('click', startWheelSpin);
        wheelCanvas.addEventListener('click', startWheelSpin);

        // ==================== –ó–ê–ö–†–´–¢–ò–ï –ú–û–î–ê–õ–û–ö ====================
        window.onclick = function(event) {
            if (event.target === nameModal) closeNameModal();
            if (event.target === victoryModal) closeVictoryModal();
            if (event.target === complimentModal) closeComplimentModal();
            if (event.target === promoModal) closePromoModal();
            if (event.target === settingsModal) closeSettingsModal();
            if (event.target === daisyModal) closeDaisyModal();
            if (event.target === wheelModal) closeWheelModal();
            if (event.target === messageModal) closeMessageModal();
        };

        document.querySelectorAll('.custom-modal-content').forEach(modal => {
            modal.addEventListener('touchmove', (e) => {
                e.stopPropagation();
            });
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (messageModal.style.display === 'flex') closeMessageModal();
                if (daisyModal.style.display === 'flex') closeDaisyModal();
                if (wheelModal.style.display === 'flex') closeWheelModal();
                if (settingsModal.style.display === 'flex') closeSettingsModal();
                if (promoModal.style.display === 'flex') closePromoModal();
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        createPetals(currentPetalCount);
        updateDisplay();
        drawWheel(wheelRotation);

        document.addEventListener('touchstart', (e) => {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>